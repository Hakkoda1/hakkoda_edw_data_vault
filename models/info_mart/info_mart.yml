version: 2

models:
  - name: dim_jaffle_customer
    description: One record per customer at Jaffle Shop.
#    tests:
#      - check_row_count_against_clone
    columns:
      - name: jaffle_customer_key
        description: Primary key
        tests:
          - unique
          - not_null 
      - name: customer_id
        description: Natural key
        tests:
          - unique 
          - not_null   
  - name: fact_order
    description: One record per Order ID. 
    columns:
      - name: fact_order_key
        description: Primary key
        tests:
          - unique
          - not_null 
      - name: order_id
        description: Natural key
        tests:
          - unique
          - not_null 
      - name: order_date_key                  
        description: Surrogate key to relate Order Date Key to Date Key in Dim Date.
        tests:
          - not_null 
          - relationships:
              to: ref('dim_date')
              field: date_key            
      - name: jaffle_customer_key                  
        description: Surrogate key to relate to Jaffle Customer Key in Dim Jaffle Customer.
        tests:
          - not_null 
          - relationships:
              to: ref('dim_jaffle_customer')
              field: jaffle_customer_key             
#      - name: order_date
#        tests:
#          - dbt_expectations.expect_row_values_to_have_recent_data:
#              datepart: hour
#              interval: 2                                